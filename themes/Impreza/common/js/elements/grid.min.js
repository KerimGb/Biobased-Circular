(function($,_undefined){"use strict";var _document=document,_window=window;$us.WGrid=function(container,options){this.init(container,options)};$us.WGrid.prototype={init:function(container,options){const self=this;this.$container=$(container);this.$filters=$('.g-filters-item',this.$container);this.$list=$('.w-grid-list',this.$container);this.$loadmore=$('.g-loadmore',this.$container);this.$pagination=$('> .pagination',this.$container);this.$preloader=$('.w-grid-preloader',this.$container);this.$style=$('> style:first',this.$container);this.loading=!1;this.changeUpdateState=!1;this.gridFilter=null;this.curFilterTaxonomy='';this.paginationType=this.$pagination.length?'regular':(this.$loadmore.length?'ajax':'none');this.filterTaxonomyName=this.$list.data('filter_taxonomy_name')?this.$list.data('filter_taxonomy_name'):'category';if(this.$container.data('gridInit')==1){return}
this.$container.data('gridInit',1);self._events={updateState:self._updateState.bind(self),updateOrderBy:self._updateOrderBy.bind(self),initMagnificPopup:self._initMagnificPopup.bind(self),usbReloadIsotopeLayout:self._usbReloadIsotopeLayout.bind(self),scrollToGrid:$ush.debounce(self.scrollToGrid.bind(self),10),};var $jsonContainer=$('.w-grid-json',this.$container);if($jsonContainer.length&&$jsonContainer.is('[onclick]')){this.ajaxData=$jsonContainer[0].onclick()||{};if(!$us.usbPreview())$jsonContainer.remove()}else{this.ajaxData={};this.ajaxUrl=''}
if(this.$list.hasClass('owl-carousel')){let carouselOptions={navElement:'button',navText:['',''],responsiveRefreshRate:100,}
$.extend(carouselOptions,this.ajaxData.carousel_settings||{});if($us.$html.hasClass('touch')||$us.$html.hasClass('ios-touch')){$.extend(carouselOptions,{mouseDrag:!1,})}
if($us.usbPreview()){$.extend(carouselOptions,{autoplayHoverPause:!0,mouseDrag:!1,touchDrag:!1,loop:!1,})}
if(carouselOptions.autoplayContinual){carouselOptions.slideTransition='linear';carouselOptions.autoplaySpeed=carouselOptions.autoplayTimeout;carouselOptions.smartSpeed=carouselOptions.autoplayTimeout;if(!carouselOptions.autoWidth){carouselOptions.slideBy=1}}
self.$list.on('initialized.owl.carousel',function(e){var $list=self.$list,$toggleLinks=$('[data-content-height]',e.currentTarget);$toggleLinks.each((_,node)=>{var $node=$(node),usCollapsibleContent=$node.data('usCollapsibleContent');if($ush.isUndefined(usCollapsibleContent)){usCollapsibleContent=$node.usCollapsibleContent().data('usCollapsibleContent')}
usCollapsibleContent.setHeight();$ush.timeout(()=>{$list.trigger('refresh.owl.carousel')},1)});if($.isMobile&&$list.closest('.w-tabs-section.active').length){$ush.timeout(()=>{$list.trigger('refresh.owl.carousel')},50)}
if(carouselOptions.autoHeight){$toggleLinks.on('showContent',()=>{$list.trigger('refresh.owl.carousel')})}});self.$list.on('mousedown.owl.core',(e)=>{if($(e.target).is('[class^="collapsible-content-"]')){let owlCarousel=self.$list.data('owl.carousel');if(owlCarousel.settings.mouseDrag){owlCarousel.$stage.trigger('mouseup.owl.core')}
if(owlCarousel.settings.touchDrag){owlCarousel.$stage.trigger('touchcancel.owl.core')}}});var owlCarousel=self.$list.owlCarousel(carouselOptions).data('owl.carousel');if(owlCarousel&&carouselOptions.autoplayContinual){this.$list.trigger('next.owl.carousel')}
if(owlCarousel&&carouselOptions.aria_labels.prev&&carouselOptions.aria_labels.next){owlCarousel.$element.find('.owl-prev').attr('aria-label',carouselOptions.aria_labels.prev);owlCarousel.$element.find('.owl-next').attr('aria-label',carouselOptions.aria_labels.next)}
let currentOwlResponsiveValue=self.$list.attr('class').match(/owl-responsive-(\d+)/)[1];let carouselOptionsResponsive=carouselOptions.responsive||{};if(carouselOptionsResponsive[currentOwlResponsiveValue]&&carouselOptionsResponsive[currentOwlResponsiveValue].items===1){self.$list.toggleClass('autoheight',carouselOptionsResponsive[currentOwlResponsiveValue].autoHeight)}}
if(this.$container.hasClass('open_items_in_popup')&&!this.$container.hasClass('us_post_list')&&!this.$container.hasClass('us_product_list')&&!$ush.isUndefined(this.ajaxData)){this.lightboxOpened=!1;this.lightboxTimer=null;this.originalURL=_window.location.href;this.$popup=$('.l-popup',this.$container);this.$popupBox=$('.l-popup-box',this.$popup);this.$popupContentPreloader=$('.l-popup-box-content .g-preloader',this.$popup);this.$popupContentFrame=$('.l-popup-box-content-frame',this.$popup);this.$popupNextArrow=$('.l-popup-arrow.to_next',this.$popup);this.$popupPrevArrow=$('.l-popup-arrow.to_prev',this.$popup);$us.$body.append(this.$popup);this.initLightboxAnchors();this.$popup.on('click','.l-popup-closer',this.hideLightbox.bind(this)).on('click','.l-popup-box',this.hideLightbox.bind(this)).on('click','.l-popup-box-content',function(e){e.stopPropagation()});$us.$window.on('resize',function(){if(this.lightboxOpened&&$us.$window.width()<$us.canvasOptions.disableEffectsWidth){this.hideLightbox()}}.bind(this))}
if(this.$list.hasClass('owl-carousel')){return}
if(this.paginationType!='none'||this.$filters.length){if(this.ajaxData==_undefined){return}
this.templateVars=this.ajaxData.template_vars||{};if(this.filterTaxonomyName){this.initialFilterTaxonomy=this.$list.data('filter_default_taxonomies')?this.$list.data('filter_default_taxonomies').toString().split(','):'';this.curFilterTaxonomy=this.initialFilterTaxonomy}
this.curPage=this.ajaxData.current_page||1;this.infiniteScroll=this.ajaxData.infinite_scroll||0}
if(this.$container.hasClass('with_isotope')){this.$list.imagesLoaded(function(){var smallestItemSelector,isotopeOptions={itemSelector:'.w-grid-item',layoutMode:(this.$container.hasClass('isotope_fit_rows'))?'fitRows':'masonry',isOriginLeft:!$('.l-body').hasClass('rtl'),transitionDuration:0};if(this.$list.find('.size_1x1').length){smallestItemSelector='.size_1x1'}else if(this.$list.find('.size_1x2').length){smallestItemSelector='.size_1x2'}else if(this.$list.find('.size_2x1').length){smallestItemSelector='.size_2x1'}else if(this.$list.find('.size_2x2').length){smallestItemSelector='.size_2x2'}
if(smallestItemSelector){smallestItemSelector=smallestItemSelector||'.w-grid-item';isotopeOptions.masonry={columnWidth:smallestItemSelector}}
this.$list.on('layoutComplete',function(){if(_window.USAnimate){$('.w-grid-item.off_autostart',this.$list).removeClass('off_autostart');new USAnimate(this.$list)}
$us.$window.trigger('scroll.waypoints')}.bind(this));this.$list.isotope(isotopeOptions);if(this.paginationType=='ajax'){this.initAjaxPagination()}
$us.$canvas.on('contentChange',function(){this.$list.imagesLoaded(function(){this.$list.isotope('layout')}.bind(this))}.bind(this))}.bind(this));self.$container.on('usbReloadIsotopeLayout',self._events.usbReloadIsotopeLayout)}else if(this.paginationType=='ajax'){this.initAjaxPagination()}
this.$filters.each(function(index,filter){var $filter=$(filter),taxonomy=$filter.data('taxonomy');$filter.on('click',function(){if(taxonomy!=this.curFilterTaxonomy){if(this.loading){return}
this.setState(1,taxonomy);this.$filters.removeClass('active');$filter.addClass('active')}}.bind(this))}.bind(this));if(this.$container.closest('.l-main').length){$us.$body.on('us_grid.updateState',self._events.updateState).on('us_grid.updateOrderBy',self._events.updateOrderBy)}
self.$container.on('scrollToGrid',self._events.scrollToGrid);self.$list.on('click','[ref=magnificPopup]',self._events.initMagnificPopup)},_updateState:function(e,queryString,page,gridFilter){var $container=this.$container;if(!$container.is('[data-filterable="true"]')||!$container.hasClass('used_by_grid_filter')||(!$container.is(':visible')&&!$container.hasClass('hidden'))){return}
page=page||1;this.changeUpdateState=!0;this.gridFilter=gridFilter;if(this.ajaxData===_undefined){this.ajaxData={}}
if(!this.hasOwnProperty('templateVars')){this.templateVars=this.ajaxData.template_vars||{query_args:{}}}
this.templateVars.us_grid_filter_query_string=queryString;if(this.templateVars.query_args!==!1){this.templateVars.query_args.paged=page}
this.templateVars.filters_args=gridFilter.filtersArgs||{};this.setState(page);if(this.paginationType==='regular'&&/page(=|\/)/.test(location.href)){var url=location.href.replace(/(page(=|\/))(\d+)(\/?)/,'$1'+page+'$2');if(history.replaceState){history.replaceState(_document.title,_document.title,url)}}},_updateOrderBy:function(e,orderby,page,gridOrder){if(!this.$container.is('[data-filterable="true"]')||!this.$container.hasClass('used_by_grid_order')){return}
page=page||1;this.changeUpdateState=!0;if(!this.hasOwnProperty('templateVars')){this.templateVars=this.ajaxData.template_vars||{query_args:{}}}
if(this.templateVars.query_args!==!1){this.templateVars.query_args.paged=page}
this.templateVars.grid_orderby=orderby;this.setState(page)},_initMagnificPopup:function(e){e.stopPropagation();e.preventDefault();var $target=$(e.currentTarget);if($target.data('magnificPopup')===_undefined){$target.magnificPopup({type:'image',mainClass:'mfp-fade'});$target.trigger('click')}},_usbReloadIsotopeLayout:function(){const self=this;if(self.$container.hasClass('with_isotope')){self.$list.isotope('layout')}},initLightboxAnchors:function(){var self=this;$('.w-grid-item-anchor:not(.lightbox_init)',self.$list).on('click',function(e){var $item=$(e.target).closest('.w-grid-item'),url=$('.w-grid-item-anchor',$item).attr('href');if(!$item.hasClass('custom-link')){if($us.$window.width()>=$us.canvasOptions.disableEffectsWidth){e.stopPropagation();e.preventDefault();self.openLightboxItem(url,$item);$item.addClass('lightbox_init')}}})},initAjaxPagination:function(){this.$loadmore.on('click',function(){if(this.curPage<this.ajaxData.max_num_pages){this.setState(this.curPage+1)}}.bind(this));if(this.infiniteScroll){$us.waypoints.add(this.$loadmore,'-70%',function(){if(!this.loading){this.$loadmore.click()}}.bind(this))}},setState:function(page,taxonomy){const self=this;if(self.loading&&!self.changeUpdateState){return}
if(page!==1&&self.paginationType=='ajax'&&self.none!==_undefined&&self.none==!0){return}
self.none=!1;self.loading=!0;self.$container.next('.w-grid-none').addClass('hidden');if(self.$filters.length&&!self.changeUpdateState){taxonomy=taxonomy||self.curFilterTaxonomy;if(taxonomy=='*'){taxonomy=self.initialFilterTaxonomy}
if(taxonomy!=''){var newTaxArgs={'taxonomy':self.filterTaxonomyName,'field':'slug','terms':taxonomy},taxQueryFound=!1;if(self.templateVars.query_args.tax_query==_undefined){self.templateVars.query_args.tax_query=[]}else{$.each(self.templateVars.query_args.tax_query,(index,taxArgs)=>{if(taxArgs!=null&&taxArgs.taxonomy==self.filterTaxonomyName){self.templateVars.query_args.tax_query[index]=newTaxArgs;taxQueryFound=!0;return!1}})}
if(!taxQueryFound){self.templateVars.query_args.tax_query.push(newTaxArgs)}}else if(self.templateVars.query_args.tax_query!=_undefined){$.each(self.templateVars.query_args.tax_query,(index,taxArgs)=>{if(taxArgs!=null&&taxArgs.taxonomy==self.filterTaxonomyName){self.templateVars.query_args.tax_query[index]=null;return!1}})}}
if(self.templateVars.query_args!==!1){self.templateVars.query_args.paged=page}
if(self.paginationType=='ajax'){if(page==1){self.$loadmore.addClass('hidden')}else{self.$loadmore.addClass('loading')}
if(!self.infiniteScroll){self.prevScrollTop=$us.$window.scrollTop()}}
if(self.paginationType!='ajax'||page==1){self.$preloader.addClass('active');if(self.$list.data('isotope')){self.$list.isotope('remove',self.$container.find('.w-grid-item'));self.$list.isotope('layout')}else{self.$container.find('.w-grid-item').remove()}}
self.ajaxData.template_vars=JSON.stringify(self.templateVars);var isotope=self.$list.data('isotope');if(isotope&&page==1){self.$list.html('');isotope.remove(isotope.items);isotope.reloadItems()}
if(self.xhr!==_undefined){self.xhr.abort()}
self.xhr=$.ajax({type:'post',url:$us.ajaxUrl,data:self.ajaxData,cache:!1,beforeSend:function(){self.$container.removeClass('hidden')},success:function(html){var $result=$(html),$container=$('.w-grid-list',$result).first(),$pagination=$('.pagination > *',$result),$items=$container.children(),smallestItemSelector;self.$container.toggleClass('hidden',!$items.length);$container.imagesLoaded(()=>{self.beforeAppendItems($items);$items.appendTo(self.$list);$container.html('');var $sliders=$items.find('.w-slider');if(isotope){isotope.insert($items);isotope.reloadItems()}
if($sliders.length){$sliders.each((index,slider)=>{$(slider).usImageSlider().find('.royalSlider').data('royalSlider').ev.on('rsAfterInit',()=>{if(isotope){self.$list.isotope('layout')}})})}
if(isotope){if(self.$list.find('.size_1x1').length){smallestItemSelector='.size_1x1'}else if(self.$list.find('.size_1x2').length){smallestItemSelector='.size_1x2'}else if(self.$list.find('.size_2x1').length){smallestItemSelector='.size_2x1'}else if(self.$list.find('.size_2x2').length){smallestItemSelector='.size_2x2'}
if(isotope.options.masonry){isotope.options.masonry.columnWidth=smallestItemSelector||'.w-grid-item'}
self.$list.isotope('layout');self.$list.trigger('layoutComplete')}
if(self.paginationType=='ajax'){if(page==1){var $jsonContainer=$result.find('.w-grid-json');if($jsonContainer.length){var ajaxData=$jsonContainer[0].onclick()||{};self.ajaxData.max_num_pages=ajaxData.max_num_pages||self.ajaxData.max_num_pages}else{self.ajaxData.max_num_pages=1}}
if(self.templateVars.query_args.paged>=self.ajaxData.max_num_pages||!$items.length){self.$loadmore.addClass('hidden')}else{self.$loadmore.removeClass('hidden').removeClass('loading')}
if(self.infiniteScroll){$us.waypoints.add(self.$loadmore,'-70%',()=>{if(!self.loading){self.$loadmore.click()}})}else if(Math.round(self.prevScrollTop)!=Math.round($us.$window.scrollTop())){$us.$window.scrollTop(self.prevScrollTop)}}else if(self.paginationType==='regular'&&self.changeUpdateState){$('a[href]',$pagination).each((_,item)=>{var $item=$(item),pathname=location.pathname.replace(/((\/page.*)?)\/$/,'');$item.attr('href',pathname+$item.attr('href'))});self.$pagination.html($pagination)}
if(self.$container.hasClass('open_items_in_popup')){self.initLightboxAnchors()}
var $result_none=$result.next('.w-grid-none');if(self.changeUpdateState&&$result_none.length){var $none=self.$container.next('.w-grid-none');if($none.length){$none.removeClass('hidden')}else{self.$container.after($result_none)}
var $nextGrid=$('.w-grid:first',self.$container.next('.w-grid-none'));if($nextGrid.length){$nextGrid.wGrid()}
self.none=!0}
if(self.changeUpdateState&&self.gridFilter){var $jsonData=$result.filter('.w-grid-filter-json-data:first');if($jsonData.length){self.gridFilter.trigger('us_grid_filter.update-items-amount',$jsonData[0].onclick()||{})}
$jsonData.remove()}
var customStyles=$('style#grid-post-content-css',$result).html()||'';if(customStyles){if(!self.$style.length){self.$style=$('<style></style>');self.$container.append(self.$style)}
self.$style.text(self.$style.text()+customStyles)}
$us.$canvas.resize();self.$preloader.removeClass('active');if(_window.USAnimate&&self.$container.hasClass('with_css_animation')){new USAnimate(self.$container)}
$ush.timeout(()=>{$us.$document.trigger('usGrid.itemsLoaded',[$items])},1)});self.$container.trigger('scrollToGrid');self.loading=!1;self.$container.trigger('USGridItemsLoaded')},error:function(){self.$loadmore.removeClass('loading')},});self.curPage=page;self.curFilterTaxonomy=taxonomy},scrollToGrid:function(){const self=this;if(self.curPage!==1){return}
var $container=self.$container;if($container.hasClass('hidden')){$container=$container.next()}
const gridPos=$ush.parseInt($container.offset().top);if(!gridPos){return}
const scrollTop=$us.$window.scrollTop();if(scrollTop>=gridPos||gridPos>=(scrollTop+_window.innerHeight)){$us.$htmlBody.stop(!0,!1).animate({scrollTop:(gridPos-$us.header.getCurrentHeight())},500)}},_hasScrollbar:function(){return _document.documentElement.scrollHeight>_document.documentElement.clientHeight},_getScrollbarSize:function(){if($us.scrollbarSize===_undefined){var scrollDiv=_document.createElement('div');scrollDiv.style.cssText='width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;';_document.body.appendChild(scrollDiv);$us.scrollbarSize=scrollDiv.offsetWidth-scrollDiv.clientWidth;_document.body.removeChild(scrollDiv)}
return $us.scrollbarSize},openLightboxItem:function(itemUrl,$item){this.showLightbox();var prevIndex,nextIndex,currentIndex=0,items=$('.w-grid-item:visible:not(.custom-link)',this.$container).toArray();for(var i in items){if($item.is(items[i])){currentIndex=parseInt(i);break}}
if(currentIndex>0){prevIndex=currentIndex-1}
if(currentIndex<items.length){nextIndex=currentIndex+1}
var $prevItem=$(typeof prevIndex==='number'?items[prevIndex]:''),$nextItem=$(typeof nextIndex==='number'?items[nextIndex]:'');if($nextItem.length>0){this.$popupNextArrow.removeClass('hidden');this.$popupNextArrow.attr('title',$nextItem.find('.w-grid-item-title').text());this.$popupNextArrow.off('click').click(function(e){var $nextItemAnchor=$nextItem.find('.w-grid-item-anchor'),nextItemUrl=$nextItemAnchor.attr('href');e.stopPropagation();e.preventDefault();this.openLightboxItem(nextItemUrl,$nextItem)}.bind(this))}else{this.$popupNextArrow.attr('title','');this.$popupNextArrow.addClass('hidden')}
if($prevItem.length>0){this.$popupPrevArrow.removeClass('hidden');this.$popupPrevArrow.attr('title',$prevItem.find('.w-grid-item-title').text());this.$popupPrevArrow.off('click').on('click',function(e){var $prevItemAnchor=$prevItem.find('.w-grid-item-anchor'),prevItemUrl=$prevItemAnchor.attr('href');e.stopPropagation();e.preventDefault();this.openLightboxItem(prevItemUrl,$prevItem)}.bind(this))}else{this.$popupPrevArrow.attr('title','');this.$popupPrevArrow.addClass('hidden')}
if(itemUrl.indexOf('?')!==-1){this.$popupContentFrame.attr('src',itemUrl+'&us_iframe=1')}else{this.$popupContentFrame.attr('src',itemUrl+'?us_iframe=1')}
if(history.replaceState){history.replaceState(null,null,itemUrl)}
this.$popupContentFrame.off('load').on('load',function(){this.lightboxContentLoaded()}.bind(this))},lightboxContentLoaded:function(){this.$popupContentPreloader.css('display','none');this.$popupContentFrame.contents().find('body').off('keyup.usCloseLightbox').on('keyup.usCloseLightbox',function(e){if($ush.toLowerCase(e.key)==='escape'){this.hideLightbox()}}.bind(this))},showLightbox:function(){clearTimeout(this.lightboxTimer);this.$popup.addClass('active');this.lightboxOpened=!0;this.$popupContentPreloader.css('display','block');$us.$html.addClass('usoverlay_fixed');if(!$.isMobile){this.windowHasScrollbar=this._hasScrollbar();if(this.windowHasScrollbar&&this._getScrollbarSize()){$us.$html.css('margin-right',this._getScrollbarSize())}}
this.lightboxTimer=setTimeout(function(){this.afterShowLightbox()}.bind(this),25)},afterShowLightbox:function(){clearTimeout(this.lightboxTimer);this.$container.on('keyup',function(e){if(this.$container.hasClass('open_items_in_popup')){if($ush.toLowerCase(e.key)==='escape'){this.hideLightbox()}}}.bind(this));this.$popupBox.addClass('show');$us.$canvas.trigger('contentChange');$us.$window.trigger('resize')},hideLightbox:function(){clearTimeout(this.lightboxTimer);this.lightboxOpened=!1;this.$popupBox.removeClass('show');if(history.replaceState){history.replaceState(null,null,this.originalURL)}
this.lightboxTimer=setTimeout(function(){this.afterHideLightbox()}.bind(this),500)},afterHideLightbox:function(){this.$container.off('keyup');clearTimeout(this.lightboxTimer);this.$popup.removeClass('active');this.$popupContentFrame.attr('src','about:blank');$us.$html.removeClass('usoverlay_fixed');if(!$.isMobile){if(this.windowHasScrollbar){$us.$html.css('margin-right','')}}},beforeAppendItems:function($items){if($('[data-content-height]',$items).length){var handle=$ush.timeout(function(){$('[data-content-height]',$items).usCollapsibleContent();$ush.clearTimeout(handle)},1)}}};$.fn.wGrid=function(options){return this.each(function(){$(this).data('wGrid',new $us.WGrid(this,options))})};$(function(){$('.w-grid').wGrid()});$('.w-grid-list').each(function(){var $list=$(this);if(!$list.find('[ref=magnificPopupGrid]').length){return}
var delegateStr='a[ref=magnificPopupGrid]:visible',popupOptions;if($list.hasClass('owl-carousel')){delegateStr='.owl-item:not(.cloned) a[ref=magnificPopupGrid]'}
popupOptions={type:'image',delegate:delegateStr,gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1],tPrev:$us.langOptions.magnificPopup.tPrev,tNext:$us.langOptions.magnificPopup.tNext,tCounter:$us.langOptions.magnificPopup.tCounter},image:{titleSrc:'aria-label'},removalDelay:300,mainClass:'mfp-fade',fixedContentPos:!0,callbacks:{beforeOpen:function(){var owlCarousel=$list.data('owl.carousel');if(owlCarousel&&owlCarousel.settings.autoplay){$list.trigger('stop.owl.autoplay')}},beforeClose:function(){var owlCarousel=$list.data('owl.carousel');if(owlCarousel&&owlCarousel.settings.autoplay){$list.trigger('play.owl.autoplay')}}}};$list.magnificPopup(popupOptions);if($list.hasClass('owl-carousel')){$list.on('initialized.owl.carousel',function(initEvent){var $currentList=$(initEvent.currentTarget),items={};$('.owl-item:not(.cloned)',$currentList).each(function(_,item){var $item=$(item),id=$item.find('[data-id]').data('id');if(!items.hasOwnProperty(id)){items[id]=$item}});$currentList.on('click','.owl-item.cloned',function(e){e.preventDefault();e.stopPropagation();var id=$('[data-id]',e.currentTarget).data('id');if(items.hasOwnProperty(id)){$('a[ref=magnificPopupGrid]',items[id]).trigger('click')}})})}})})(jQuery)